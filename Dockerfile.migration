# ----------------------------
# Dockerfile.migration
# ----------------------------
FROM node:20-alpine

WORKDIR /app

# Copy only what's necessary
COPY package*.json ./
RUN npm ci

# Copy migration or seed scripts
COPY ./scripts ./scripts
COPY ./models ./models
COPY ./config ./config

# Environment variables (better passed from runtime)
ENV NODE_ENV=production
ENV MONGODB_URI=mongodb://mongodb-service:27017/mallickshop

# Default command to run migrations
CMD ["node", "scripts/migrate.js"]

